<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link rel="stylesheet" href="tailwindcss.css">
	<link rel="stylesheet" type="text/css" href="index.css">
	<link rel="stylesheet" href="fontawesome/css/all.min.css">
	<style type="text/css">
		html,
		body {

			margin: 0;
			overflow: hidden !important;
			background: #eae4e4;
			scrollbar-width: none;
		}

		html::-webkit-scrollbar,
		body::-webkit-scrollbar {
			display: none !important;
		}

		body {
			display: flex;
		}

		html.mode-sidepanel,
		body.mode-sidepanel {
			width: 100vw !important;
			height: 100vh !important;
			max-width: 100vw !important;
			max-height: 100vh !important;
			min-width: 360px;
			min-height: 100vh !important;
		}

		html.mode-popup,
		body.mode-popup {
			width: 375px !important;
			height: 640px !important;
			min-width: 360px;
			max-width: 420px;
			min-height: 640px !important;
			max-height: 640px !important;
		}

		#popupRoot {
			flex: 1;
			height: 100%;
			overflow-y: auto;
			overflow-x: hidden;
		}

		.loader-container {
			display: none;
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(255, 255, 255, 0.8);
			z-index: 1000;
			justify-content: center;
			align-items: center;
		}

		.spinner {
			width: 50px;
			height: 50px;
			border: 5px solid #f3f3f3;
			border-top: 5px solid #3498db;
			border-radius: 50%;
			animation: spin 1s linear infinite;
		}

		@keyframes spin {
			0% {
				transform: rotate(0deg);
			}

			100% {
				transform: rotate(360deg);
			}
		}

		/* Tooltip style */
		.tooltip {
			position: relative;
			display: inline-block;
			cursor: help;
		}

		.tooltip .tooltiptext {
			visibility: hidden;
			width: 200px;
			background-color: #333;
			color: #fff;
			text-align: center;
			border-radius: 6px;
			padding: 8px;
			position: absolute;
			z-index: 1001;
			bottom: 125%;
			left: 50%;
			transform: translateX(-50%);
			opacity: 0;
			transition: opacity 0.3s;
			font-size: 0.7rem;
			font-weight: normal;
			line-height: 1.4;
			pointer-events: none;
			box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
		}

		.tooltip:hover .tooltiptext {
			visibility: visible;
			opacity: 1;
		}

		.tooltip .tooltiptext::after {
			content: "";
			position: absolute;
			top: 100%;
			left: 50%;
			margin-left: -5px;
			border-width: 5px;
			border-style: solid;
			border-color: #333 transparent transparent transparent;
		}

		/* Repository filter styles */
		.repo-item {
			display: flex;
			align-items: center;
			padding: 4px 8px;
			border-radius: 4px;
			cursor: pointer;
		}

		.repo-item:hover {
			background-color: #f3f4f6;
		}

		.repo-item.selected {
			background-color: #eff6ff;
		}

		/* Dark mode repository filter styles */
		.dark-mode .repo-item:hover {
			background-color: #374151;
		}

		.dark-mode .repo-item.selected {
			background-color: #1e3a8a;
		}

		#repoList {
			border: 1px solid #e5e7eb;
			max-height: 200px;
			overflow-y: auto;
		}

		.dark-mode #repoList {
			border-color: #4b5563;
		}
	</style>
	<title data-i18n="extShortName">Scrum Helper</title>
</head>

<body>
	<div id="popupRoot">
		<div class="px-4 py-4 min-w-[360px]">
			<!-- Header -->
			<div class="bg-white rounded-3xl p-4 shadow-sm mb-4">
				<div class="flex justify-between items-center mb-2">
					<h3 class="text-3xl font-semibold text-gray-800" data-i18n="extName">Scrum Helper</h3>
					<div class="flex items-center gap-1">
						<button id="themeToggle" class="p-2 rounded-full hover:bg-gray-100 transition-colors">
							<i class="fa fa-moon-o text-xl"></i>
						</button>
					</div>
				</div>
				<p class="text-sm text-gray-700 leading-relaxed mb-4" data-i18n="extDescription">
					Report your development progress by auto-fetching your Git activity for a selected period
				</p>
				<div class="flex items-center justify-between">
					<div class="flex items-center gap-2">
						<span class="text-sm font-medium text-gray-700" data-i18n="disableLabel">Disable</span>
						<label class="relative inline-flex items-center cursor-pointer">
							<input type="checkbox" id="enableToggle" class="sr-only peer" checked>
							<div
								class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600">
							</div>
						</label>
						<span class="text-sm font-medium text-gray-700" data-i18n="enableLabel">Enable</span>
					</div>
					<div class="flex gap-4">
						<button id="homeIcon" class="text-gray-700 hover:text-blue-600 transition-colors">
							<i class="fa fa-home text-3xl"></i>
						</button>
						<button id="settingsIcon" class="text-gray-700 hover:text-blue-600 transition-colors">
							<i class="fa fa-cog text-3xl"></i>
						</button>
					</div>
				</div>
			</div>

			<!-- Main View -->
			<div id="mainView" class="space-y-4">
				<div class="bg-white rounded-3xl p-4 shadow-sm">
					<div class="space-y-4">
						<!-- Platform Selection -->
						<div>
							<label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="platformLabel">
								Platform
							</label>
							<div class="relative">
								<select id="platformSelect"
									class="w-full bg-gray-100 border-2 border-gray-200 rounded-xl py-2 px-10 text-gray-800 appearance-none focus:outline-none focus:border-blue-500 transition-colors">
									<option value="github">GitHub</option>
									<option value="gitlab">GitLab</option>
								</select>
								<i id="platformIcon" class="fa fa-github absolute left-3 top-3 text-gray-600"></i>
								<i
									class="fa fa-chevron-down absolute right-3 top-3 text-gray-600 pointer-events-none"></i>
							</div>
						</div>

						<!-- Project Name -->
						<div>
							<label for="projectName" class="flex items-center font-medium text-gray-800 mb-2">
								<span data-i18n="projectNameLabel">Project Name (used in email subject)</span>
								<div class="tooltip ml-1">
									<i class="fa fa-question-circle text-gray-600"></i>
									<span class="tooltiptext">Name of the project you are reporting for. This appears in
										the report subject.</span>
								</div>
							</label>
							<input type="text" id="projectName" data-i18n-placeholder="projectNamePlaceholder"
								placeholder="e.g. Apache Fineract"
								class="w-full bg-gray-100 border-2 border-gray-200 rounded-xl py-2 px-4 text-gray-800 focus:outline-none focus:border-blue-500 transition-colors">
						</div>

						<!-- Username -->
						<div>
							<label id="usernameLabel" class="block text-sm font-medium text-gray-700 mb-2"
								data-i18n="usernameLabel">
								Your Github Username
							</label>
							<input type="text" id="platformUsername" data-i18n-placeholder="usernamePlaceholder"
								placeholder="Enter username"
								class="w-full bg-gray-100 border-2 border-gray-200 rounded-xl py-2 px-4 text-gray-800 focus:outline-none focus:border-blue-500 transition-colors">
						</div>

						<!-- Date Selection -->
						<div>
							<p class="text-sm font-semibold text-gray-800 mb-2" data-i18n="dateSelectionLabel">
								Fetch your contributions between:
							</p>
							<div class="flex items-center gap-4 mb-3">
								<div class="flex-1">
									<label for="startingDate"
										class="flex items-center font-medium text-xs text-gray-800 mb-1"
										data-i18n="startDateLabel">From:</label>
									<input type="date" id="startingDate"
										class="w-full bg-gray-100 border-2 border-gray-200 rounded-xl p-1 text-gray-800 text-sm focus:outline-none focus:border-blue-500 transition-colors">
								</div>
								<div class="flex-1">
									<label for="endingDate"
										class="flex items-center font-medium text-xs text-gray-800 mb-1"
										data-i18n="endDateLabel">To:</label>
									<input type="date" id="endingDate"
										class="w-full bg-gray-100 border-2 border-gray-200 rounded-xl p-1 text-gray-800 text-sm focus:outline-none focus:border-blue-500 transition-colors">
								</div>
								<div id="customDateContainer" class="flex items-center gap-2 mt-4 cursor-pointer">
									<input type="radio" id="yesterdayContribution" name="timeframe"
										class="w-4 h-4 cursor-pointer" checked>
									<label for="yesterdayContribution"
										class="text-sm font-medium text-gray-700 cursor-pointer"
										data-i18n="yesterdayLabel">Previous day</label>
								</div>
							</div>
						</div>

						<!-- Checkboxes -->
						<div class="space-y-2">
							<div class="flex items-center gap-2">
								<input type="checkbox" id="showOpenPRs" class="w-4 h-4 text-blue-600 rounded">
								<label for="showOpenPRs" class="text-sm font-medium text-gray-700"
									data-i18n="showPRLabelsLabel">Show
									PRs Labels</label>
							</div>

							<div class="flex items-center gap-2">
								<input type="checkbox" id="onlyIssues" class="w-4 h-4 text-blue-600 rounded">
								<label for="onlyIssues" class="text-sm font-medium text-gray-700"
									data-i18n="onlyIssuesLabel">Include
									only issues in the report</label>
								<div class="tooltip">
									<i class="fa fa-question-circle text-gray-600"></i>
									<span class="tooltiptext">If checked, pull requests will be excluded from the report
										body.</span>
								</div>
							</div>

							<div class="flex items-center gap-2">
								<input type="checkbox" id="onlyPRs" class="w-4 h-4 text-blue-600 rounded">
								<label for="onlyPRs" class="text-sm font-medium text-gray-700"
									data-i18n="onlyPRsLabel">Include
									only PRs in the report</label>
								<div class="tooltip">
									<i class="fa fa-question-circle text-gray-600"></i>
									<span class="tooltiptext">If checked, issues will be excluded from the report
										body.</span>
								</div>
							</div>

							<div class="flex items-center gap-2">
								<input type="checkbox" id="onlyRevPRs" class="w-4 h-4 text-blue-600 rounded">
								<label for="onlyRevPRs" class="text-sm font-medium text-gray-700"
									data-i18n="onlyReviewedPRsLabel">Include only reviewed PRs in the report</label>
								<div class="tooltip">
									<i class="fa fa-question-circle text-gray-600"></i>
									<span class="tooltiptext">If checked, only PRs that have received a review will be
										included.</span>
								</div>
							</div>

							<div class="flex items-center gap-2">
								<input type="checkbox" id="showCommits" class="w-4 h-4 text-blue-600 rounded">
								<label for="showCommits" class="text-sm font-medium text-gray-700"
									data-i18n="showCommitsLabel">Show commits on open PRs/ draft PRs</label>
								<div class="tooltip">
									<i class="fa fa-question-circle text-gray-600"></i>
									<span class="tooltiptext">If checked, commit messages for open or draft pull
										requests will be listed.</span>
								</div>
							</div>
						</div>

						<!-- Report Section -->
						<div class="border-t-2 border-gray-100 pt-4">
							<h6 class="text-base font-semibold mt-2" data-i18n="scrumReportLabel">Scrum Report</h6>
							<div id="scrumReport" contenteditable="true"
								class="min-h-[200px] overflow-y-auto whitespace-pre-wrap border-2 border-gray-200 bg-gray-100 rounded-xl text-gray-800 p-2 my-2">
							</div>
						</div>
						<div class="flex justify-between gap-2">
							<button id="generateReport"
								class="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded">
								<i class="fa fa-refresh"></i> <span data-i18n="generateReportButton">Generate
									Report</span>
							</button>
							<button id="copyReport"
								class="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded">
								<i class="fa fa-copy"></i> <span data-i18n="copyReportButton">Copy Report</span>
							</button>
						</div>

						<!-- Information Note -->
						<div class="bg-gray-100 rounded-3xl p-4 mt-4">
							<h6 class="text-xl font-semibold text-gray-800 mb-2" data-i18n="noteHeader">Note:</h6>
							<p class="text-sm text-gray-700" data-i18n="noteLabel">
								Pull requests are fetched based on the most recent review activity by any contributor,
								not just your own. Please review and adjust the generated SCRUM report to ensure it
								accurately reflects your work before sharing.
							</p>
						</div>
					</div>
				</div>
			</div>

			<!-- Settings View -->
			<div id="settingsView" class="hidden space-y-4">
				<div class="bg-white rounded-3xl p-4 shadow-sm">
					<div class="flex items-center gap-2 mb-4">
						<button id="backToMain" class="text-gray-700 hover:text-blue-600 transition-colors">
							<i class="fa fa-arrow-left text-xl"></i>
						</button>
						<h4 class="text-xl font-semibold text-gray-800" data-i18n="settingsLabel">Settings</h4>
					</div>

					<div class="space-y-4">
						<!-- Auth Tokens -->
						<div id="githubTokenSection">
							<label class="flex items-center font-medium text-gray-800 mb-2">
								<span data-i18n="githubTokenLabel">Your Github Token</span>
								<div class="tooltip ml-1">
									<i class="fa fa-question-circle text-gray-600"></i>
									<span class="tooltiptext">Required for making authenticated requests to the GitHub
										API.</span>
								</div>
							</label>
							<div class="relative">
								<input type="password" id="githubToken" data-i18n-placeholder="tokenPlaceholder"
									placeholder="Required for making authenticated requests"
									class="w-full bg-gray-100 border-2 border-gray-200 rounded-xl py-2 px-4 pr-10 text-gray-800 focus:outline-none focus:border-blue-500 transition-colors">
								<button id="toggleGithubToken" class="absolute right-3 top-2.5 text-black">
									<i class="fa fa-eye"></i>
								</button>
							</div>
						</div>

						<div id="gitlabTokenSection" class="hidden">
							<label class="flex items-center font-medium text-gray-800 mb-2">
								<span data-i18n="gitlabTokenLabel">Your GitLab Token</span>
								<div class="tooltip ml-1">
									<i class="fa fa-question-circle text-gray-600"></i>
									<span class="tooltiptext">Required for making authenticated requests to the GitLab
										API.</span>
								</div>
							</label>
							<div class="relative">
								<input type="password" id="gitlabToken" data-i18n-placeholder="tokenPlaceholder"
									placeholder="Required for making authenticated requests"
									class="w-full bg-gray-100 border-2 border-gray-200 rounded-xl py-2 px-4 pr-10 text-gray-800 focus:outline-none focus:border-blue-500 transition-colors">
								<button id="toggleGitlabToken" class="absolute right-3 top-2.5 text-black">
									<i class="fa fa-eye"></i>
								</button>
							</div>
						</div>

						<!-- Organization Filter -->
						<div id="orgNameSection">
							<label for="orgName" class="flex items-center font-medium text-gray-800 mb-2">
								<span data-i18n="orgNameLabel">Organization Name</span>
								<div class="tooltip ml-1">
									<i class="fa fa-question-circle text-gray-600"></i>
									<span class="tooltiptext">Filters pull requests and issues by the specified
										organization.</span>
								</div>
							</label>
							<input type="text" id="orgName" placeholder="e.g. apache"
								class="w-full bg-gray-100 border-2 border-gray-200 rounded-xl py-2 px-4 text-gray-800 focus:outline-none focus:border-blue-500 transition-colors">
						</div>

						<!-- Repository Filter (GitHub only) -->
						<div id="repoFilterSection">
							<div class="flex items-center justify-between mb-2">
								<label class="flex items-center font-medium text-gray-800">
									<span data-i18n="repoFilterLabel">Filter by repositories</span>
									<div class="tooltip ml-1">
										<i class="fa fa-question-circle text-gray-600"></i>
										<span class="tooltiptext">Only fetch contributions from these specific
											repositories. (Requires Token)</span>
									</div>
								</label>
								<div class="flex items-center gap-2">
									<input type="checkbox" id="useRepoFilter" class="w-4 h-4 text-blue-600 rounded">
									<span class="text-sm text-gray-700" data-i18n="enableFilteringLabel">Enable
										filtering</span>
								</div>
							</div>

							<div id="repoFilterContainer" class="hidden space-y-2">
								<div class="relative">
									<input type="text" id="repoSearch" data-i18n-placeholder="searchReposPlaceholder"
										placeholder="Search repositories..."
										class="w-full bg-gray-100 border border-gray-300 rounded-xl py-2 px-4 text-sm focus:outline-none focus:border-blue-500">
									<div id="repoDropdown"
										class="absolute w-full bg-white border border-gray-300 rounded-xl shadow-lg hidden max-h-48 overflow-y-auto">
										<div id="repoList" class="p-1"></div>
									</div>
								</div>
								<div id="selectedRepoTags" class="flex flex-wrap gap-2"></div>
								<div id="repoStatus" class="text-xs text-gray-500 italic"></div>
								<div id="tokenWarning" class="hidden text-xs text-red-500 mt-1">
									<i class="fa fa-exclamation-triangle"></i> <span
										data-i18n="repoFilterTokenWarning">Please enter a GitHub token to use repository
										filtering.</span>
								</div>
							</div>
						</div>

						<div class="bg-blue-300 h-0.5 w-full"></div>

						<!-- Cache TTL -->
						<div>
							<label class="flex items-center font-medium text-gray-800 mb-2">
								<span data-i18n="cacheTtlLabel">Cache Duration (minutes)</span>
								<div class="tooltip ml-1">
									<i class="fa fa-question-circle text-gray-600"></i>
									<span class="tooltiptext">How long to store fetched Git data locally before
										refreshing.</span>
								</div>
							</label>
							<div class="flex items-center gap-4">
								<input type="number" id="cacheTtl" min="1" max="1440"
									class="w-24 bg-gray-100 border-2 border-gray-200 rounded-xl py-2 px-4 text-gray-800 focus:outline-none focus:border-blue-500 transition-colors">
								<button id="refreshCache"
									class="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded">
									<i class="fa fa-refresh"></i> <span data-i18n="refreshCacheButton">Refresh
										Data</span>
								</button>
							</div>
						</div>

						<div class="bg-blue-300 h-0.5 w-full"></div>

						<!-- Display Mode Notice -->
						<div>
							<label class="flex items-center font-medium text-gray-800 mb-2">
								<span data-i18n="displayModeLabel">Extension Window Mode</span>
							</label>
							<select id="displayMode"
								class="w-full bg-gray-100 border-2 border-gray-200 rounded-xl py-2 px-4 text-gray-800 focus:outline-none focus:border-blue-500 transition-colors">
								<option value="sidePanel">Side Panel</option>
								<option value="popup">Popup</option>
							</select>
							<div id="displayModeNotice"
								class="hidden text-xs text-blue-700 bg-blue-50 border border-blue-200 rounded-xl p-2 mt-1 mb-2 flex items-center gap-2">
								<i class="fa fa-info-circle"></i>
								<span id="displayModeNoticeText"></span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<script src="scripts/jquery-3.2.1.min.js"></script>
	<script type="text/javascript" src="materialize/js/materialize.min.js"></script>
	<script src="scripts/notifications.js"></script>
	<script src="scripts/emailClientAdapter.js"></script>
	<script src="scripts/main.js"></script>
	<script src="scripts/gitlabHelper.js"></script>
	<script src="scripts/scrumHelper.js"></script>
	<script src="scripts/popup.js"></script>
</body>

</html>